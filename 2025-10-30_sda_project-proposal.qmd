---
title: "Project Proposal"
author: "E. Duke Chase"
date: today
---
```{r}
#| label: setup
#| include: false

library(here)
source(here::here("R", "setup.R"))

# Set key directory paths
data_dir <- here::here("data")
output_dir <- here::here("output")

pt_df <- read.csv(here("data", "patient_info.csv"))
cell_df <- read.csv(here("data", "scaled_mibi_data_w_cell_gating.csv"))
```

Provide the the following information for your project.

1. What research question(s) do you hope to answer?

::: {.answer-box}
  Do the relative distributions of tumor, immune, and stromal (structural) cells in a tumor relate to disease outcome after immunotherapy?
:::


2. From where did you obtain the data you will use to answer your research question? Please provide a link I can follow, if possible.

::: {.answer-box}
  Data were obtained from the article *[Processed Multiplexed Ion Beam Imaging (MIBI) of tumor microenvironments of 54 melanoma samples following immunotherapy](https://data.mendeley.com/datasets/79y7bht7tf/2)* on Mendeley Data
:::


3. How many observations does your data set have?

```{r}
#| label: observations

num_pt <- length(unique(cell_df$fov))
min_cells <- range(count(cell_df, fov)[2])[1]
max_cells <- range(count(cell_df, fov)[2])[2]
```



::: {.answer-box}
  - The first dataset contains a small amount of demographic and outcome data on `r num_pt` patients with melanoma who had received immunotherapy for their cancer.
  - The second dataset contains spatial data on cells in a biopsy sampled from each patients melanoma. The number of cells in each sample varies from `r min_cells` to `r max_cells`, for a total of `r nrow(cell_df)` observations.
:::

4. Are you merging multiple data sets?

::: {.answer-box}
  The information from the two datasets will be merged as part of the analysis, but I won't be combining the two datasets into a single dataset because it would add a lot of extra entries without improving the ability to do my analysis.
:::


5. Provide a table listing each variable you are considering for analysis, briefly describe each variable (e.g., the number of disease cases in each region), and the variable type (e.g., numeric, factor, date, etc.).

```{r}
#| label: analysis-vars

var_names <- c("Patient ID", "Age Tertile at Diagnosis", "Stage at Diagnosis", "Response", "CR", "PR", "SD", "PD" ,  "Response (binary)", "Cell Type", "Immune", "Stromal", "Tumor", "Centroid Location", "Cell Area", "Tumor-Immune", "Tumor-Stromal", "Immune-Stromal")
var_desc <- c(
  "Unique identifier for each patient.",
  "Which tertile of patient ages the patient falls in.",
  "Roman numeral cancer stage at diagnosis",
  "How the patients melanoma responded ot the immunotherapy treatment",
  "Complete response",
  "Partial response",
  "Stable disease",
  "Progressive disease",
  "A binary version which indicates whether the disease progressed or not",
  "Type of cell in the biopsy sample",
  "Immune cell", 
  "Stromal cell", 
  "Tumor cell",
  "x- and y- locations of each cell in the biopsy sample",
  "Estimated cell area",
  "Distribution of immune cells relative to tumor cells",
  "Distribution of tumor cells amongst stromal cells",
  "Dispersion of immune cells amongst the stromal cells"
)
var_type <- c("Character", "Categorical", "Categorical", "Categorical", "", "", "", "", "Boolean", "Categorical", "", "", "", "Spatial", "Numeric", "Numeric", "Numeric", "Numeric")

var_table <- tibble("Variable Name" = var_names, "Description" = var_desc, "Variable Type" = var_type)

var_table |> 
  kable("html", booktabs = TRUE) |> 
  add_indent(positions = c(5:8, 11:13))
```



6. What will your response variable be for answering the research question(s)?

::: {.answer-box}
  I'm planning on doing a multinomial logistic regression model using the treatment response variable, but if time constraints or analytic difficulty become an issue I can fall back on the binary treatment response variable as my outcome.
:::

7. Provide relevant exploratory plots of your data.

::: {.answer-box}
  Answer here
:::

8. What methods do you plan to use to answer your question of interest?

::: {.answer-box}
  Answer here
:::

